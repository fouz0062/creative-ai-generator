{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.230.0"},"children":{"ZiaGenDataStack":{"id":"ZiaGenDataStack","path":"ZiaGenDataStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.230.0"},"children":{"ZiaGenImageBucket":{"id":"ZiaGenImageBucket","path":"ZiaGenDataStack/ZiaGenImageBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ZiaGenDataStack/ZiaGenImageBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"corsConfiguration":{"corsRules":[{"allowedHeaders":["*"],"allowedMethods":["GET"],"allowedOrigins":["*"]}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"ignorePublicAcls":true},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}]}}},"Policy":{"id":"Policy","path":"ZiaGenDataStack/ZiaGenImageBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ZiaGenDataStack/ZiaGenImageBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"ZiaGenImageBucket630841F2"},"policyDocument":{"Statement":[{"Action":"s3:GetObject","Effect":"Allow","Principal":{"AWS":"*"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["ZiaGenImageBucket630841F2","Arn"]},"/*"]]}},{"Action":["s3:DeleteObject*","s3:GetBucket*","s3:List*","s3:PutBucketPolicy"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["ZiaGenImageBucket630841F2","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ZiaGenImageBucket630841F2","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"ZiaGenDataStack/ZiaGenImageBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.230.0","metadata":[]},"children":{"Default":{"id":"Default","path":"ZiaGenDataStack/ZiaGenImageBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.230.0"}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"ZiaGenDataStack/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.230.0"},"children":{"Staging":{"id":"Staging","path":"ZiaGenDataStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.230.0"}},"Role":{"id":"Role","path":"ZiaGenDataStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.230.0"}},"Handler":{"id":"Handler","path":"ZiaGenDataStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.230.0"}}}},"ZiaGenImagesTable":{"id":"ZiaGenImagesTable","path":"ZiaGenDataStack/ZiaGenImagesTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ZiaGenDataStack/ZiaGenImagesTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"userId","attributeType":"S"},{"attributeName":"timestamp","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"userId","keyType":"HASH"},{"attributeName":"timestamp","keyType":"RANGE"}],"tableName":"ZiaGenImages"}}},"ScalingRole":{"id":"ScalingRole","path":"ZiaGenDataStack/ZiaGenImagesTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.230.0","metadata":[]}}}},"ImageBucketName":{"id":"ImageBucketName","path":"ZiaGenDataStack/ImageBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"ImagesTableName":{"id":"ImagesTableName","path":"ZiaGenDataStack/ImagesTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"ZiaGenDataStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Default":{"id":"Default","path":"ZiaGenDataStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.230.0"}}}},"Exports":{"id":"Exports","path":"ZiaGenDataStack/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Output{\"Fn::GetAtt\":[\"ZiaGenImagesTable10279342\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"ZiaGenImagesTable10279342\",\"Arn\"]}","path":"ZiaGenDataStack/Exports/Output{\"Fn::GetAtt\":[\"ZiaGenImagesTable10279342\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"Output{\"Fn::GetAtt\":[\"ZiaGenImageBucket630841F2\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"ZiaGenImageBucket630841F2\",\"Arn\"]}","path":"ZiaGenDataStack/Exports/Output{\"Fn::GetAtt\":[\"ZiaGenImageBucket630841F2\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"Output{\"Ref\":\"ZiaGenImagesTable10279342\"}":{"id":"Output{\"Ref\":\"ZiaGenImagesTable10279342\"}","path":"ZiaGenDataStack/Exports/Output{\"Ref\":\"ZiaGenImagesTable10279342\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"Output{\"Ref\":\"ZiaGenImageBucket630841F2\"}":{"id":"Output{\"Ref\":\"ZiaGenImageBucket630841F2\"}","path":"ZiaGenDataStack/Exports/Output{\"Ref\":\"ZiaGenImageBucket630841F2\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ZiaGenDataStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.230.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ZiaGenDataStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.230.0"}}}},"ZiaGenCognitoStack":{"id":"ZiaGenCognitoStack","path":"ZiaGenCognitoStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.230.0"},"children":{"ZiaGenUserPool":{"id":"ZiaGenUserPool","path":"ZiaGenCognitoStack/ZiaGenUserPool","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPool","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ZiaGenCognitoStack/ZiaGenUserPool/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPool","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPool","aws:cdk:cloudformation:props":{"accountRecoverySetting":{"recoveryMechanisms":[{"name":"verified_phone_number","priority":1},{"name":"verified_email","priority":2}]},"adminCreateUserConfig":{"allowAdminCreateUserOnly":false},"autoVerifiedAttributes":["email"],"emailVerificationMessage":"The verification code to your new account is {####}","emailVerificationSubject":"Verify your new account","policies":{"passwordPolicy":{"minimumLength":8,"requireLowercase":true,"requireUppercase":true,"requireNumbers":true,"requireSymbols":false}},"smsVerificationMessage":"The verification code to your new account is {####}","usernameAttributes":["email"],"userPoolName":"ZiaGenUserPool","verificationMessageTemplate":{"defaultEmailOption":"CONFIRM_WITH_CODE","emailMessage":"The verification code to your new account is {####}","emailSubject":"Verify your new account","smsMessage":"The verification code to your new account is {####}"}}}},"ZiaGenAppClient":{"id":"ZiaGenAppClient","path":"ZiaGenCognitoStack/ZiaGenUserPool/ZiaGenAppClient","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolClient","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ZiaGenCognitoStack/ZiaGenUserPool/ZiaGenAppClient/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolClient","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolClient","aws:cdk:cloudformation:props":{"allowedOAuthFlows":["implicit","code"],"allowedOAuthFlowsUserPoolClient":true,"allowedOAuthScopes":["profile","phone","email","openid","aws.cognito.signin.user.admin"],"callbackUrLs":["https://example.com"],"explicitAuthFlows":["ALLOW_USER_SRP_AUTH","ALLOW_REFRESH_TOKEN_AUTH"],"supportedIdentityProviders":["COGNITO"],"userPoolId":{"Ref":"ZiaGenUserPool18898014"}}}}}}}},"UserPoolId":{"id":"UserPoolId","path":"ZiaGenCognitoStack/UserPoolId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"UserPoolClientId":{"id":"UserPoolClientId","path":"ZiaGenCognitoStack/UserPoolClientId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"ZiaGenCognitoStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Default":{"id":"Default","path":"ZiaGenCognitoStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.230.0"}}}},"Exports":{"id":"Exports","path":"ZiaGenCognitoStack/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Output{\"Ref\":\"ZiaGenUserPoolZiaGenAppClientBCB156E4\"}":{"id":"Output{\"Ref\":\"ZiaGenUserPoolZiaGenAppClientBCB156E4\"}","path":"ZiaGenCognitoStack/Exports/Output{\"Ref\":\"ZiaGenUserPoolZiaGenAppClientBCB156E4\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"Output{\"Ref\":\"ZiaGenUserPool18898014\"}":{"id":"Output{\"Ref\":\"ZiaGenUserPool18898014\"}","path":"ZiaGenCognitoStack/Exports/Output{\"Ref\":\"ZiaGenUserPool18898014\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ZiaGenCognitoStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.230.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ZiaGenCognitoStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.230.0"}}}},"ZiaGenApiStack":{"id":"ZiaGenApiStack","path":"ZiaGenApiStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.230.0"},"children":{"GenerateImageHandler":{"id":"GenerateImageHandler","path":"ZiaGenApiStack/GenerateImageHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.230.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ZiaGenApiStack/GenerateImageHandler/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.230.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ZiaGenApiStack/GenerateImageHandler/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.230.0","metadata":[]}},"Resource":{"id":"Resource","path":"ZiaGenApiStack/GenerateImageHandler/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ZiaGenApiStack/GenerateImageHandler/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ZiaGenApiStack/GenerateImageHandler/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchWriteItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:PutItem","dynamodb:UpdateItem"],"Effect":"Allow","Resource":{"Fn::ImportValue":"ZiaGenDataStack:ExportsOutputFnGetAttZiaGenImagesTable10279342Arn8B9AAC52"}},{"Action":["s3:Abort*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging"],"Effect":"Allow","Resource":[{"Fn::ImportValue":"ZiaGenDataStack:ExportsOutputFnGetAttZiaGenImageBucket630841F2ArnA77A973C"},{"Fn::Join":["",[{"Fn::ImportValue":"ZiaGenDataStack:ExportsOutputFnGetAttZiaGenImageBucket630841F2ArnA77A973C"},"/*"]]}]},{"Action":"bedrock:InvokeModel","Effect":"Allow","Resource":"arn:aws:bedrock:us-east-1::foundation-model/amazon.titan-image-generator-v1"}],"Version":"2012-10-17"},"policyName":"GenerateImageHandlerServiceRoleDefaultPolicy9321207A","roles":[{"Ref":"GenerateImageHandlerServiceRoleCCC027F3"}]}}}}}}},"Code":{"id":"Code","path":"ZiaGenApiStack/GenerateImageHandler/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.230.0"},"children":{"Stage":{"id":"Stage","path":"ZiaGenApiStack/GenerateImageHandler/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.230.0"}},"AssetBucket":{"id":"AssetBucket","path":"ZiaGenApiStack/GenerateImageHandler/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.230.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ZiaGenApiStack/GenerateImageHandler/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-686123098700-us-east-1","s3Key":"302fa980644ed498891a32ec97ec5a97b6f503f6db270bae4600c40270b7f82a.zip"},"environment":{"variables":{"DYNAMODB_TABLE_NAME":{"Fn::ImportValue":"ZiaGenDataStack:ExportsOutputRefZiaGenImagesTable10279342BEC091D7"},"S3_BUCKET_NAME":{"Fn::ImportValue":"ZiaGenDataStack:ExportsOutputRefZiaGenImageBucket630841F2A6EEFDEF"}}},"handler":"index.handler","memorySize":512,"role":{"Fn::GetAtt":["GenerateImageHandlerServiceRoleCCC027F3","Arn"]},"runtime":"nodejs20.x","timeout":30}}}}},"ImageGenerationApi":{"id":"ImageGenerationApi","path":"ZiaGenApiStack/ImageGenerationApi","constructInfo":{"fqn":"@aws-cdk/aws-apigatewayv2-alpha.HttpApi","version":"2.114.1-alpha.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ZiaGenApiStack/ImageGenerationApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnApi","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Api","aws:cdk:cloudformation:props":{"corsConfiguration":{"allowHeaders":["Content-Type","Authorization"],"allowMethods":["*"],"allowOrigins":["*"],"maxAge":86400},"name":"ImageGenerationApi","protocolType":"HTTP"}}},"DefaultStage":{"id":"DefaultStage","path":"ZiaGenApiStack/ImageGenerationApi/DefaultStage","constructInfo":{"fqn":"@aws-cdk/aws-apigatewayv2-alpha.HttpStage","version":"2.114.1-alpha.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ZiaGenApiStack/ImageGenerationApi/DefaultStage/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnStage","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Stage","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ImageGenerationApi809B35D9"},"autoDeploy":true,"stageName":"$default"}}}}},"POST--generate":{"id":"POST--generate","path":"ZiaGenApiStack/ImageGenerationApi/POST--generate","constructInfo":{"fqn":"@aws-cdk/aws-apigatewayv2-alpha.HttpRoute","version":"2.114.1-alpha.0","metadata":[]},"children":{"GenerateImageIntegration":{"id":"GenerateImageIntegration","path":"ZiaGenApiStack/ImageGenerationApi/POST--generate/GenerateImageIntegration","constructInfo":{"fqn":"@aws-cdk/aws-apigatewayv2-alpha.HttpIntegration","version":"2.114.1-alpha.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ZiaGenApiStack/ImageGenerationApi/POST--generate/GenerateImageIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ImageGenerationApi809B35D9"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["GenerateImageHandlerB7D52802","Arn"]},"payloadFormatVersion":"2.0"}}}}},"GenerateImageIntegration-Permission":{"id":"GenerateImageIntegration-Permission","path":"ZiaGenApiStack/ImageGenerationApi/POST--generate/GenerateImageIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["GenerateImageHandlerB7D52802","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:686123098700:",{"Ref":"ImageGenerationApi809B35D9"},"/*/*/generate"]]}}}},"Resource":{"id":"Resource","path":"ZiaGenApiStack/ImageGenerationApi/POST--generate/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ImageGenerationApi809B35D9"},"authorizationType":"JWT","authorizerId":{"Ref":"ImageGenerationApiUserPoolAuthorizerC5F0CF07"},"routeKey":"POST /generate","target":{"Fn::Join":["",["integrations/",{"Ref":"ImageGenerationApiPOSTgenerateGenerateImageIntegration9D090958"}]]}}}}}},"UserPoolAuthorizer":{"id":"UserPoolAuthorizer","path":"ZiaGenApiStack/ImageGenerationApi/UserPoolAuthorizer","constructInfo":{"fqn":"@aws-cdk/aws-apigatewayv2-alpha.HttpAuthorizer","version":"2.114.1-alpha.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ZiaGenApiStack/ImageGenerationApi/UserPoolAuthorizer/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnAuthorizer","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Authorizer","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ImageGenerationApi809B35D9"},"authorizerType":"JWT","identitySource":["$request.header.Authorization"],"jwtConfiguration":{"audience":[{"Fn::ImportValue":"ZiaGenCognitoStack:ExportsOutputRefZiaGenUserPoolZiaGenAppClientBCB156E4FA302D10"}],"issuer":{"Fn::Join":["",["https://cognito-idp.us-east-1.amazonaws.com/",{"Fn::ImportValue":"ZiaGenCognitoStack:ExportsOutputRefZiaGenUserPool188980141C00F5C5"}]]}},"name":"UserPoolAuthorizer"}}}}},"GET--images":{"id":"GET--images","path":"ZiaGenApiStack/ImageGenerationApi/GET--images","constructInfo":{"fqn":"@aws-cdk/aws-apigatewayv2-alpha.HttpRoute","version":"2.114.1-alpha.0","metadata":[]},"children":{"ListImagesIntegration":{"id":"ListImagesIntegration","path":"ZiaGenApiStack/ImageGenerationApi/GET--images/ListImagesIntegration","constructInfo":{"fqn":"@aws-cdk/aws-apigatewayv2-alpha.HttpIntegration","version":"2.114.1-alpha.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ZiaGenApiStack/ImageGenerationApi/GET--images/ListImagesIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ImageGenerationApi809B35D9"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["ListImagesHandlerE2C9E6FE","Arn"]},"payloadFormatVersion":"2.0"}}}}},"ListImagesIntegration-Permission":{"id":"ListImagesIntegration-Permission","path":"ZiaGenApiStack/ImageGenerationApi/GET--images/ListImagesIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["ListImagesHandlerE2C9E6FE","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:686123098700:",{"Ref":"ImageGenerationApi809B35D9"},"/*/*/images"]]}}}},"Resource":{"id":"Resource","path":"ZiaGenApiStack/ImageGenerationApi/GET--images/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ImageGenerationApi809B35D9"},"authorizationType":"JWT","authorizerId":{"Ref":"ImageGenerationApiUserPoolAuthorizerC5F0CF07"},"routeKey":"GET /images","target":{"Fn::Join":["",["integrations/",{"Ref":"ImageGenerationApiGETimagesListImagesIntegrationBE8357EA"}]]}}}}}},"DELETE--images--{imageId}":{"id":"DELETE--images--{imageId}","path":"ZiaGenApiStack/ImageGenerationApi/DELETE--images--{imageId}","constructInfo":{"fqn":"@aws-cdk/aws-apigatewayv2-alpha.HttpRoute","version":"2.114.1-alpha.0","metadata":[]},"children":{"DeleteImageIntegration":{"id":"DeleteImageIntegration","path":"ZiaGenApiStack/ImageGenerationApi/DELETE--images--{imageId}/DeleteImageIntegration","constructInfo":{"fqn":"@aws-cdk/aws-apigatewayv2-alpha.HttpIntegration","version":"2.114.1-alpha.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ZiaGenApiStack/ImageGenerationApi/DELETE--images--{imageId}/DeleteImageIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ImageGenerationApi809B35D9"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["DeleteImageHandlerD5538914","Arn"]},"payloadFormatVersion":"2.0"}}}}},"DeleteImageIntegration-Permission":{"id":"DeleteImageIntegration-Permission","path":"ZiaGenApiStack/ImageGenerationApi/DELETE--images--{imageId}/DeleteImageIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["DeleteImageHandlerD5538914","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:686123098700:",{"Ref":"ImageGenerationApi809B35D9"},"/*/*/images/{imageId}"]]}}}},"Resource":{"id":"Resource","path":"ZiaGenApiStack/ImageGenerationApi/DELETE--images--{imageId}/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ImageGenerationApi809B35D9"},"authorizationType":"JWT","authorizerId":{"Ref":"ImageGenerationApiUserPoolAuthorizerC5F0CF07"},"routeKey":"DELETE /images/{imageId}","target":{"Fn::Join":["",["integrations/",{"Ref":"ImageGenerationApiDELETEimagesimageIdDeleteImageIntegration15FD4061"}]]}}}}}}}},"ListImagesHandler":{"id":"ListImagesHandler","path":"ZiaGenApiStack/ListImagesHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.230.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ZiaGenApiStack/ListImagesHandler/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.230.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ZiaGenApiStack/ListImagesHandler/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.230.0","metadata":[]}},"Resource":{"id":"Resource","path":"ZiaGenApiStack/ListImagesHandler/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ZiaGenApiStack/ListImagesHandler/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ZiaGenApiStack/ListImagesHandler/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:ConditionCheckItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:Scan"],"Effect":"Allow","Resource":{"Fn::ImportValue":"ZiaGenDataStack:ExportsOutputFnGetAttZiaGenImagesTable10279342Arn8B9AAC52"}}],"Version":"2012-10-17"},"policyName":"ListImagesHandlerServiceRoleDefaultPolicyFD837FAA","roles":[{"Ref":"ListImagesHandlerServiceRole8636F168"}]}}}}}}},"Code":{"id":"Code","path":"ZiaGenApiStack/ListImagesHandler/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.230.0"},"children":{"Stage":{"id":"Stage","path":"ZiaGenApiStack/ListImagesHandler/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.230.0"}},"AssetBucket":{"id":"AssetBucket","path":"ZiaGenApiStack/ListImagesHandler/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.230.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ZiaGenApiStack/ListImagesHandler/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-686123098700-us-east-1","s3Key":"af197e6b09fdb1fd991052a007b9a576743bf8872276b43b4ec0a28248e18bb2.zip"},"environment":{"variables":{"DYNAMODB_TABLE_NAME":{"Fn::ImportValue":"ZiaGenDataStack:ExportsOutputRefZiaGenImagesTable10279342BEC091D7"}}},"handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["ListImagesHandlerServiceRole8636F168","Arn"]},"runtime":"nodejs20.x","timeout":10}}}}},"DeleteImageHandler":{"id":"DeleteImageHandler","path":"ZiaGenApiStack/DeleteImageHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.230.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ZiaGenApiStack/DeleteImageHandler/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.230.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ZiaGenApiStack/DeleteImageHandler/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.230.0","metadata":[]}},"Resource":{"id":"Resource","path":"ZiaGenApiStack/DeleteImageHandler/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ZiaGenApiStack/DeleteImageHandler/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.230.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ZiaGenApiStack/DeleteImageHandler/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":{"Fn::ImportValue":"ZiaGenDataStack:ExportsOutputFnGetAttZiaGenImagesTable10279342Arn8B9AAC52"}},{"Action":"s3:DeleteObject*","Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::ImportValue":"ZiaGenDataStack:ExportsOutputFnGetAttZiaGenImageBucket630841F2ArnA77A973C"},"/*"]]}}],"Version":"2012-10-17"},"policyName":"DeleteImageHandlerServiceRoleDefaultPolicy993EDB43","roles":[{"Ref":"DeleteImageHandlerServiceRoleCD024EA3"}]}}}}}}},"Code":{"id":"Code","path":"ZiaGenApiStack/DeleteImageHandler/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.230.0"},"children":{"Stage":{"id":"Stage","path":"ZiaGenApiStack/DeleteImageHandler/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.230.0"}},"AssetBucket":{"id":"AssetBucket","path":"ZiaGenApiStack/DeleteImageHandler/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.230.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ZiaGenApiStack/DeleteImageHandler/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.230.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-686123098700-us-east-1","s3Key":"9fb5e257c114e84591b208c98843b49052ac5c166fec1d41754ce4329f7e2855.zip"},"environment":{"variables":{"DYNAMODB_TABLE_NAME":{"Fn::ImportValue":"ZiaGenDataStack:ExportsOutputRefZiaGenImagesTable10279342BEC091D7"},"S3_BUCKET_NAME":{"Fn::ImportValue":"ZiaGenDataStack:ExportsOutputRefZiaGenImageBucket630841F2A6EEFDEF"}}},"handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["DeleteImageHandlerServiceRoleCD024EA3","Arn"]},"runtime":"nodejs20.x","timeout":10}}}}},"ApiUrl":{"id":"ApiUrl","path":"ZiaGenApiStack/ApiUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.230.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"ZiaGenApiStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Default":{"id":"Default","path":"ZiaGenApiStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.230.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ZiaGenApiStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.230.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ZiaGenApiStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.230.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"}}}}}